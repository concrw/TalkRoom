# TalkRoom 프로젝트 개발 규칙

## 언어 규칙
- **코드**: 영어로 작성 (변수명, 함수명, 주석 모두 영어)
- **사용자와 대화**: 한국어로 설명 및 응답
- **커밋 메시지**: 영어 사용

## 필수 참조 문서
- `TalkRoom_프로젝트_종합문서.md` - 프로젝트 기획 및 아키텍처
- `프로젝트_비교분석_및_통합기획.md` - BMIC/TALKROOM 통합 전략
- `통합작업_완료보고서.md` - 현재 프로젝트 상태
- 이 문서와 충돌하는 요청은 반드시 사용자에게 확인

## 절대 금지 사항
1. ❌ 요청하지 않은 기능 추가 금지 (Scope creep)
2. ❌ any 사용 최소화 (불가피한 경우 예외, 타입 정의 우선)
3. ❌ @ts-ignore 사용 금지 (절대 금지)
4. ❌ 기존 함수명/API 변경 금지 (Breaking change)
5. ❌ 파일 전체 재작성 금지 (Edit 도구 사용)
6. ❌ Over-engineering 금지 (추상화, 유틸리티 남발)
7. ❌ 미리 최적화 금지 (useMemo, useCallback 남발)

## 문서 생성 규칙
1. ✅ 프로젝트 진행에 필수적인 문서는 생성 가능
2. ✅ 사용자가 명시적으로 요청한 문서는 생성
3. ✅ 통합/마이그레이션 작업 시 요약 문서 생성 권장
4. ❌ 불필요한 주석, 과도한 README 자동 생성 금지

## 기술 스택 선택 원칙
1. ✅ 더 나은 기술 스택 선택은 허용 (사용자와 협의)
2. ✅ 프로젝트 상황에 맞는 최적의 도구 사용
3. ✅ 기존 코드가 이미 다른 패턴을 사용하면 그대로 유지
4. ❌ 무분별한 새 패키지 설치 금지 (사용자 확인 필요)

## 필수 준수 사항
1. ✅ 수정 전 반드시 파일 먼저 읽기
2. ✅ 요청한 것만 정확히 구현
3. ✅ 가장 간단한 방법 선택
4. ✅ 기존 코드 스타일/패턴 따르기
5. ✅ TypeScript strict 모드 준수
6. ✅ Edit 도구로 최소 변경만
7. ✅ 불확실하면 먼저 질문하기
8. ✅ 이모지 사용 금지 (사용자가 명시적으로 요청한 경우 제외)

## 현재 기술 스택 (BMIC + TALKROOM 통합 완료)

### 프론트엔드
- React 18.3.1
- TypeScript 5.8.3
- Vite 5.4.19
- React Router DOM 6.30.1
- TanStack Query 5.83.0 (서버 상태 관리)
- Tailwind CSS 3.4.17
- shadcn/ui (49개 컴포넌트)
- Radix UI (접근성)
- Lucide React (아이콘)
- Sonner (토스트 알림)

### 상태 관리 전략
- React Query (서버 상태)
- React Context + Hooks (useAuth)
- 로컬 상태는 useState
- Zustand는 현재 미사용 (필요시 도입 가능)

### 백엔드
- Supabase PostgreSQL
- Supabase Auth (인증)
- Supabase Realtime (실시간 채팅)
- Supabase Storage (파일 업로드)

### 배포
- Vercel (권장)

## 작업 원칙

### 파일 수정 시
1. Read 도구로 파일 먼저 읽기
2. 기존 패턴 100% 유지
3. Edit 도구로 최소한만 수정
4. Write 도구로 전체 재작성 금지

### 새 기능 추가 시
1. 기획서에 명시된 것만
2. MVP Phase 1 범위 엄수
3. 요청 외 개선사항 추가 금지
4. 가장 간단한 구현 선택

### 에러 처리
1. 시스템 경계에만 try-catch
2. 내부 함수에 과도한 에러 처리 금지
3. 발생 불가능한 에러 처리 금지
4. any로 에러 회피 금지

### 타입 안전성
1. any 사용 최소화 (외부 라이브러리 타입 이슈 시 예외)
2. @ts-ignore 절대 사용 금지
3. as unknown as 최소화
4. 정확한 타입 정의 우선 사용

## 코드 스타일 (현재 프로젝트 패턴)

### 컴포넌트 구조
```typescript
export default function Component() {
  const { user } = useAuth();
  const { toast } = useToast();

  const { data, isLoading } = useQuery({
    queryKey: ['key'],
    queryFn: async () => {
      const { data, error } = await supabase.from('table').select('*');
      if (error) throw error;
      return data;
    },
  });

  const handleAction = async () => {
    try {
      await action();
      toast({ title: "Success" });
    } catch (error) {
      toast({ title: "Error", variant: "destructive" });
    }
  };

  if (isLoading) return <div>Loading...</div>;

  return <div>...</div>;
}
```

### Supabase 통합
```typescript
import { supabase } from '@/integrations/supabase/client';

// Direct query
const { data, error } = await supabase
  .from('table_name')
  .select('*')
  .order('created_at', { ascending: false });

if (error) throw error;
```

### Auth Hook 사용
```typescript
import { useAuth } from '@/hooks/useAuth';

export default function Page() {
  const { user, loading } = useAuth();

  if (loading) return <div>Loading...</div>;
  if (!user) return <Navigate to="/auth" />;

  return <div>...</div>;
}
```

## 의심스러울 때

1. 통합작업_완료보고서.md 확인 (현재 상태)
2. TalkRoom_프로젝트_종합문서.md 확인 (기획)
3. 기존 코드 패턴 확인 (src/pages, src/components)
4. 사용자에게 질문
5. 추측으로 수정 금지

## 핵심 원칙

- 요청한 것만 구현
- 가장 간단한 방법 선택
- 기존 패턴 유지
- 필요한 문서는 생성 가능
- 더 나은 기술 스택 제안 가능 (협의 필요)
- Edit 도구로 최소 변경
- 불확실하면 질문
